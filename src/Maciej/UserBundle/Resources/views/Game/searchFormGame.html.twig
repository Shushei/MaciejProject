   
{% extends 'MaciejUserBundle:Default:Default.html.twig' %}
{% block body %}
      <div class="container">
 <h1 class="mt-4 mb-3">Game Search
      </h1>

      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="index.html">Lorem Ipsum</a>
        </li>
        <li class="breadcrumb-item active">Search Game . . .</li>
      </ol>
    <div class="row">
        <div class="col-md-8" id="searchdelete">
            <p id="add">
        </div>
        <div class="col-md-4">
            
            <h5 class="card-header">Search</h5>
            <div class="card-body">
              <div class="input-group">
                 {{ form_start(form) }}
                    {{ form_widget(form) }}
                
                {{ form_end(form) }}
                <button class="btn btn-primary" id="searchButton">Search</button>
            </div>
       
        </div>
    </div>
      </div>
                <script type="text/javascript">
        $("#searchButton").click(function () {
            $("#searchdelete").html("<p id='add'>");
        var size ;
        var page;
        var title = $("#search_game_searchTitle").val();
        var company = $("#search_game_searchCompany").val();
        var minDate = $("#search_game_minDate").val();
        var maxDate = $("#search_game_maxDate").val();
        criteria = {
                title: title,
                company: company,
                minDate: minDate,
                maxDate: maxDate}
        $(".gameRow").remove();
        $.ajax({
        method: "GET",
                url: "http://shushei.site/app_dev.php/api2/game/ajax/update",
                dataType: "json",
                contentType: "application/json",
                data: {page: page,
                        size: size,
                        criteria},
                success: function (a) {
                $("#loading").remove();  
                
                $.each(a, function (key, element) {
                    console.log(element);
                var date = new Date(element.release_date);
                var day = date.getDate();
                var month = date.getMonth() + 1;
                var year = date.getFullYear();
                var path = "{{ path('usergamesingle', {'id' : 'element.id'})}}";
                    path = path.replace('element.id', element.id);

                    if (typeof element.logolink == 'undefined'){
                        var asset = "http://placehold.it/700x300";
                    } else {
                        var asset = element.logolink;
                    }
                    

                    $("#add").before(
                        $("<div class=row id=game" + element.id + "></div>").html(
                            "<div class='col-md-7'>"+
                            "<img class='img-fluid rounded mb-3 mb-md-0' id=gamelogolink"+element.id+" src='' alt=''>"+
                            "</div><div class='col-md-5'>"+
                            "<h3>" + element.title+"</h3>"+
                            "<p>" +
                                "Game Title: "+ element.title +"</br>"+
                                "Released By: "+element.company.company+ "</br>"+
                                "Release Date : "+year+"-"+month+"-"+day+" </br>"+
                                "Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laudantium veniam exercitationem expedita laborum at voluptate. Labore, voluptates totam at aut nemo deserunt rem magni pariatur quos perspiciatis atque eveniet unde.</p>"+
                            "<a class='btn btn-primary' id=gamelink" + element.id + ">View Game"+
                            "<span class='glyphicon glyphicon-chevron-right'></span>"+
                            "</a></div></div>"
                             ));
                    $("#gamelink" + element.id).attr("href", path); 
                    $("#gamelogolink" + element.id).attr("src", asset); 
                });
                },
                error: function () {
                alert("There is no records matching query");
                return false;
                }
        });
        });

    </script>
    {%endblock%}
